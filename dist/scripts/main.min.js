<<<<<<< HEAD
app.map=app.map||{},function(){app.map={init:function(){var e={lat:39.927677,lng:-75.171909},a=document.getElementById("map-container");this.map=new google.maps.Map(a,{center:e,zoom:14,minZoom:12,maxZoom:18,mapTypeControl:!1}),this.placesApi=new google.maps.places.PlacesService(app.map.map),this.infoWindow=new google.maps.InfoWindow({maxWidth:.7*$(window).width()}),google.maps.event.addListener(this.infoWindow,"closeclick",function(){app.viewmodel.infoWindow(!1)}),setTimeout(function(){app.viewmodel.mapError("There appears to be a problem with Google Maps, please try refreshing the page")},5e3),google.maps.event.addListenerOnce(this.map,"bounds_changed",this.getPlaces)},createPlaces:function(e){e.forEach(function(e,a){var o=new app.viewmodel.Place(e);app.viewmodel.places.push(o),app.viewmodel.placeList.push(o.name()),1===a&&app.viewmodel.curPlace(o)}),app.viewmodel.autocomplete()},storePlaces:function(e){localStorage.setItem("places",JSON.stringify(e))},retrievePlaces:function(){var e=JSON.parse(localStorage.places);return e.forEach(function(e){var a=e.geometry.location.lat,o=e.geometry.location.lng;e.geometry.location.lat=function(){return a},e.geometry.location.lng=function(){return o}}),e},getPlaces:function(){if(localStorage.places&&app.map.sameBoundsCheck())console.log("Creating places from storage"),app.map.createPlaces(app.map.retrievePlaces()),ko.applyBindings(app.viewmodel);else{localStorage.setItem("bounds",JSON.stringify(app.map.map.getBounds()));var e={bounds:app.map.map.getBounds(),types:["art_gallery","museum","park"]};app.map.placesApi.nearbySearch(e,function(e,a){if(console.log("Calling Places API"),"OK"===a)app.map.setPhotoUrls(e),app.map.storePlaces(e),app.map.createPlaces(e);else{console.log("We have a places error");var o="Google Places Error: "+a;app.viewmodel.addError(o)}ko.applyBindings(app.viewmodel)})}},sameBoundsCheck:function(){var e=JSON.parse(localStorage.bounds);return app.map.map.getBounds().equals(e)},setPhotoUrls:function(e){e.forEach(function(e){if(e.photos){var a=e.photos[0].getUrl({maxWidth:200,maxHeight:300});e.photos[0].url=a}})},getPlaceDetails:function(e){var a={placeId:e.data.place_id};app.map.placesApi.getDetails(a,function(a,o){if("OK"===o){var t=new app.viewmodel.PlaceDetails(a);e.details(t)}else{var i="Google Places Error while getting details: "+o;app.viewmodel.addError(i)}})},createMarker:function(e){var a=e.data.geometry.location,o={url:e.data.icon,scaledSize:new google.maps.Size(50,50)},t=new google.maps.Marker({animation:google.maps.Animation.DROP,attribution:{source:"mrkjesus2.github.io/Neighborhood-Map"},icon:o,map:app.map.map,place:{location:{lat:a.lat(),lng:a.lng()},placeId:e.data.place_id},title:e.data.name});return google.maps.event.addListener(t,"click",function(){app.viewmodel.clickHandler(e)}),t}}}(),app.foursquare=app.foursquare||{},function(){var e="ZBGAM3NOJCK4P345ELK2JIB232FMDENJ05GXYQRSAHOHURJR",a="RGEF2DNONIR0AN2GHSIIMGZWLT0IH5JSJCJ5AGFAJ2WZDGLH";app.foursquare={baseUrl:"https://api.foursquare.com/v2/venues/",version:"20140806",findPlace:function(o){var t=o.data.geometry.location;jQuery.ajax({url:this.baseUrl+"search",data:{query:o.name(),ll:t.lat()+","+t.lng(),client_id:e,client_secret:a,v:this.version,limit:"1"},dataType:"json"}).done(function(e){var a=e.response.venues[0];app.foursquare.getTips(a,o)}).fail(function(e){var a="Foursquare Error: "+e.statusText;app.viewmodel.addError(a)})},getTips:function(o,t){jQuery.ajax({url:this.baseUrl+o.id+"/tips",data:{client_id:e,client_secret:a,v:this.version},dataType:"json"}).done(function(e){var a=e.response.tips;app.viewmodel.fourSquare(o,a,t),app.viewmodel.setInfoWindow(t)}).fail(function(e){var a="Foursquare Tips Error: "+e.statusText;app.viewmodel.addError(a)})}}}(),app.wiki=app.wiki||{},function(){app.wiki={getWiki:function(e){jQuery.ajax({url:"https://en.wikipedia.org/w/api.php",data:{action:"query",prop:"categories|extracts|info",exintro:"",exchars:1e3,inprop:"url",format:"json",redirects:"",converttitles:"",titles:e.name()},dataType:"jsonp",headers:{"Api-User-Agent":"Mark's Udacity Project"}}).done(function(a){var o=Object.keys(a.query.pages)[0],t=new app.viewmodel.WikiPage(a.query.pages[o]);void 0===t.content()||app.wiki.ambiguityChk(a,o)||(e.wikiInfo(t),app.viewmodel.setInfoWindow(e))}).fail(function(e){var a="Wikipedia Error: "+e.statusText;app.viewmodel.addError(a)})},ambiguityChk:function(e,a){var o=e.query.pages[a].categories;for(var t in o)return"Category:All article disambiguation pages"===o[t].title?!0:!1}}}(),app.viewmodel=app.viewmodel||{},app.viewmodel={mapError:ko.observable(),places:ko.observableArray(),placeList:[],curMarker:null,curPlace:ko.observable(),inputText:ko.observable(""),frsqr:null,errorMsg:ko.observableArray([]),infoWindow:ko.observable(!1),drawerOpen:ko.observable(!1),showModal:ko.observable(!1),Place:function(e){this.show=ko.observable(!0),this.name=ko.observable(e.name),this.rating=ko.observable(e.rating),this.open=ko.observable(e.opening_hours?"Open Now":"Closed"),e.photos?this.photo=ko.observable({url:ko.observable(e.photos[0].url),height:ko.observable(e.photos[0].height),width:ko.observable(e.photos[0].width),attributions:ko.observable(e.photos[0].html_attributions)}||{}):this.photo=ko.observable("none"),this.data=e,this.detailsIcon=ko.observable("fa fa-chevron-circle-up"),this.details=ko.observable(),this.marker=app.map.createMarker(this),this.wikiInfo=ko.observable(),this.frSqrInfo=ko.observable()},WikiPage:function(e){this.content=ko.observable(e.extract),this.url=ko.observable(e.fullurl)},fourSquare:function(e,a,o){var t=ko.mapping.fromJS(e,{}),i=ko.mapping.fromJS(a,{});t.tips=i,o.frSqrInfo(t)},PlaceDetails:function(e){this.show=ko.observable(!0),this.address=ko.observable(e.formatted_address),this.phone=ko.observable(e.formatted_phone_number),this.photos=ko.observableArray(e.photos),this.rating=ko.observable(e.rating),this.website=ko.observable(e.website),this.reviews=ko.observableArray(new app.viewmodel.Reviews(e.reviews))},Reviews:function(e){var a=[];return e.forEach(function(e){a.push({author:ko.observable(e.author_name),authorUrl:ko.observable(e.author_url),text:ko.observable(e.text),time:ko.observable(e.time)})}),a},addError:function(e){this.errorMsg=this.errorMsg||ko.observableArray([]),this.errorMsg.push(e),setTimeout(function(){app.viewmodel.clearErrors()},2e3)},clearErrors:function(){this.errorMsg([])},setCurrentPlace:function(e){app.viewmodel.curPlace().marker.getAnimation()&&app.viewmodel.toggleBounce(),app.viewmodel.curPlace(e)},toggleDetails:function(e){void 0!==e.details()&&e.details().show()===!0?(e.details().show(!1),e.detailsIcon("fa fa-chevron-circle-up")):(app.map.getPlaceDetails(e),app.viewmodel.setCurrentPlace(e),e.detailsIcon("fa fa-chevron-circle-down"))},clickContactInfo:function(){this.inputText(this.curPlace().name()),app.viewmodel.placeFilter(),this.toggleDetails(app.viewmodel.curPlace()),app.map.infoWindow.close(),app.viewmodel.infoWindow(!1),this.toggleDrawer()},clickHandler:function(e){var a=e||this;app.wiki.getWiki(a),app.foursquare.findPlace(a),app.map.infoWindow.close(),app.viewmodel.drawerOpen()&&app.viewmodel.toggleDrawer(),app.viewmodel.setCurrentPlace(a),app.viewmodel.toggleBounce()},findPlaceByName:function(e){for(var a=app.viewmodel.places(),o=a.length-1;o>=0;o--)if(a[o].name()===e)return a[o];return!1},placeFilter:function(){var e=this;if(e.inputText()){var a=e.places().filter(function(a){var o=a.name().toLowerCase(),t=e.inputText().toLowerCase();return o.indexOf(t)>=0});e.places().forEach(function(e){e.marker.setMap(null),e.show(!1)}),a.forEach(function(e){e.marker.setMap(app.map.map),e.show(!0)})}else e.places().forEach(function(e){e.marker.setMap(app.map.map),e.show(!0)});return!0},resetFilter:function(){app.viewmodel.inputText(""),app.viewmodel.placeFilter();for(var e=this.places(),a=e.length-1;a>=0;a--)e[a].details()&&e[a].details().show()&&(e[a].details().show(!1),e[a].detailsIcon("fa fa-chevron-circle-up"))},setInfoWindow:function(e){var a=$("#infowindow").html();app.map.infoWindow.setContent(a),app.map.infoWindow.open(app.map.map,e.marker),app.viewmodel.infoWindow(!0)},toggleBounce:function(){if(app.viewmodel.curPlace().marker.getAnimation())app.viewmodel.curPlace().marker.setAnimation(null);else{var e=app.viewmodel.curPlace().marker;e.setAnimation(google.maps.Animation.BOUNCE)}},toggleDrawer:function(){app.viewmodel.drawerOpen(!app.viewmodel.drawerOpen())},setModal:function(){app.viewmodel.showModal(!app.viewmodel.showModal())},autocomplete:function(){var e=document.getElementById("place-input"),a=new Awesomplete(e);a.list=app.viewmodel.placeList,e.addEventListener("awesomplete-selectcomplete",function(){var e=app.viewmodel.findPlaceByName(this.value);console.log(e),app.viewmodel.setCurrentPlace(e),app.viewmodel.toggleDetails(e),app.viewmodel.inputText(this.value),app.viewmodel.placeFilter()})}};
||||||| merged common ancestors
/*!
 *
 *  Web Starter Kit
 *  Copyright 2015 Google Inc. All rights reserved.
 *
 *  Licensed under the Apache License, Version 2.0 (the "License");
 *  you may not use this file except in compliance with the License.
 *  You may obtain a copy of the License at
 *
 *    https://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License
 *
 */
!function(){"use strict";var e=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));"serviceWorker"in navigator&&("https:"===window.location.protocol||e)&&navigator.serviceWorker.register("service-worker.js").then(function(e){"function"==typeof e.update&&e.update(),e.onupdatefound=function(){if(navigator.serviceWorker.controller){var a=e.installing;a.onstatechange=function(){switch(a.state){case"installed":break;case"redundant":throw new Error("The installing service worker became redundant.")}}}}})["catch"](function(e){console.error("Error during service worker registration:",e)})}();var app=app||{};app.map=app.map||{},function(){app.map={init:function(){var e={lat:39.927677,lng:-75.171909},a=document.getElementById("map-container");this.map=new google.maps.Map(a,{center:e,zoom:14,minZoom:12,maxZoom:18,mapTypeControl:!1}),this.placesApi=new google.maps.places.PlacesService(app.map.map),this.infoWindow=new google.maps.InfoWindow({maxWidth:.7*$(window).width()}),google.maps.event.addListener(this.infoWindow,"closeclick",app.viewmodel.showDrawerBtn),setTimeout(function(){$("#maps-error").css("display","inline")},5e3),google.maps.event.addListenerOnce(this.map,"bounds_changed",this.getPlaces)},createPlaces:function(e){e.forEach(function(e,a){var o=new app.viewmodel.Place(e);app.viewmodel.places.push(o),1===a&&app.viewmodel.curPlace(o)})},storePlaces:function(e){localStorage.setItem("places",JSON.stringify(e))},retrievePlaces:function(){var e=JSON.parse(localStorage.places);return e.forEach(function(e){var a=e.geometry.location.lat,o=e.geometry.location.lng;e.geometry.location.lat=function(){return a},e.geometry.location.lng=function(){return o}}),e},getPlaces:function(){if(localStorage.places)console.log("Creating places from storage"),app.map.createPlaces(app.map.retrievePlaces()),ko.applyBindings(app.viewmodel);else{var e={bounds:app.map.map.getBounds(),types:["art_gallery","museum","park"]};app.map.placesApi.nearbySearch(e,function(e,a){if(console.log("Calling Places API"),"OK"===a)app.map.setPhotoUrls(e),app.map.storePlaces(e),app.map.createPlaces(e);else{console.log("We have a places error");var o="Google Places Error: "+a;app.viewmodel.addError(o)}ko.applyBindings(app.viewmodel)})}},setPhotoUrls:function(e){e.forEach(function(e){if(e.photos){var a=e.photos[0].getUrl({maxWidth:200,maxHeight:300});e.photos[0].url=a}})},getPlaceDetails:function(e){var a={placeId:e.data.place_id};app.map.placesApi.getDetails(a,function(a,o){if(console.log("status",o),"OK"===o){var t=new app.viewmodel.PlaceDetails(a);e.details(t)}else{var r="Google Places Error while getting details: "+o;app.viewmodel.addError(r)}})},createMarker:function(e){var a=e.data.geometry.location,o=new google.maps.Marker({animation:google.maps.Animation.DROP,attribution:{source:"mrkjesus2.github.io/Neighborhood-Map"},icon:e.data.icon,map:app.map.map,place:{location:{lat:a.lat(),lng:a.lng()},placeId:e.data.place_id},title:e.data.name});return google.maps.event.addListener(o,"click",function(){app.viewmodel.clickHandler(e)}),o}}}(),app.foursquare=app.foursquare||{},function(){var e="ZBGAM3NOJCK4P345ELK2JIB232FMDENJ05GXYQRSAHOHURJR",a="RGEF2DNONIR0AN2GHSIIMGZWLT0IH5JSJCJ5AGFAJ2WZDGLH";app.foursquare={baseUrl:"https://api.foursquare.com/v2/venues/",version:"20140806",findPlace:function(o){var t=o.data.geometry.location;jQuery.ajax({url:this.baseUrl+"search",data:{query:o.name(),ll:t.lat()+","+t.lng(),client_id:e,client_secret:a,v:this.version,limit:"1"},dataType:"json"}).done(function(e){var a=e.response.venues[0];app.foursquare.getTips(a,o)}).fail(function(e){var a="Foursquare Error: "+e.statusText;app.viewmodel.addError(a)})},getTips:function(o,t){jQuery.ajax({url:this.baseUrl+o.id+"/tips",data:{client_id:e,client_secret:a,v:this.version},dataType:"json"}).done(function(e){var a=e.response.tips;app.viewmodel.fourSquare(o,a,t)}).fail(function(e){var a="Foursquare Tips Error: "+e.statusText;app.viewmodel.addError(a)})}}}(),app.wiki=app.wiki||{},function(){app.wiki={getWiki:function(e){jQuery.ajax({url:"https://en.wikipedia.org/w/api.php",data:{action:"query",prop:"categories|extracts|info",exintro:"",exchars:1e3,inprop:"url",format:"json",redirects:"",converttitles:"",titles:e.name()},dataType:"jsonp",headers:{"Api-User-Agent":"Mark's Udacity Project"}}).done(function(a){var o=Object.keys(a.query.pages)[0],t=new app.viewmodel.WikiPage(a.query.pages[o]);void 0===t.content()||app.wiki.ambiguityChk(a,o)||e.wikiInfo(t)}).fail(function(e){var a="Wikipedia Error: "+e.statusText;app.viewmodel.addError(a)})},ambiguityChk:function(e,a){var o=e.query.pages[a].categories;for(var t in o)return"Category:All article disambiguation pages"===o[t].title?!0:!1}}}(),app.viewmodel=app.viewmodel||{},app.viewmodel={places:ko.observableArray(),curMarker:null,curPlace:ko.observable(),inputText:ko.observable(""),frsqr:null,errorMsg:ko.observableArray([]),Place:function(e){this.show=ko.observable(!0),this.name=ko.observable(e.name),this.rating=ko.observable(e.rating),this.open=ko.observable(e.opening_hours?"Open Now":"Closed"),e.photos?this.photo=ko.observable({url:ko.observable(e.photos[0].url),height:ko.observable(e.photos[0].height),width:ko.observable(e.photos[0].width),attributions:ko.observable(e.photos[0].html_attributions)}||{}):this.photo=ko.observable("none"),this.data=e,this.detailsIcon=ko.observable("fa fa-chevron-circle-up"),this.details=ko.observable(),this.marker=app.map.createMarker(this),this.wikiInfo=ko.observable(),this.frSqrInfo=ko.observable()},WikiPage:function(e){this.content=ko.observable(e.extract),this.url=ko.observable(e.fullurl)},fourSquare:function(e,a,o){var t=ko.mapping.fromJS(e,{}),r=ko.mapping.fromJS(a,{});t.tips=r,o.frSqrInfo(t)},PlaceDetails:function(e){this.show=ko.observable(!0),this.address=ko.observable(e.formatted_address),this.phone=ko.observable(e.formatted_phone_number),this.photos=ko.observableArray(e.photos),this.rating=ko.observable(e.rating),this.website=ko.observable(e.website),this.reviews=ko.observableArray(new app.viewmodel.Reviews(e.reviews))},Reviews:function(e){var a=[];return e.forEach(function(e){a.push({author:ko.observable(e.author_name),authorUrl:ko.observable(e.author_url),text:ko.observable(e.text),time:ko.observable(e.time)})}),a},addError:function(e){this.errorMsg=this.errorMsg||ko.observableArray([]),this.errorMsg.push(e),setTimeout(function(){app.viewmodel.clearErrors()},2e3)},clearErrors:function(){this.errorMsg([])},setCurrentPlace:function(e){app.viewmodel.curPlace().marker.getAnimation()&&app.viewmodel.toggleBounce(),app.viewmodel.curPlace(e)},toggleDetails:function(e){void 0!==e.details()&&e.details().show()===!0?(e.details().show(!1),e.detailsIcon("fa fa-chevron-circle-up")):(app.map.getPlaceDetails(e),app.viewmodel.setCurrentPlace(e),e.detailsIcon("fa fa-chevron-circle-down"))},clickContactInfo:function(){this.inputText(this.curPlace().name()),$("#drawer-top input").trigger("input"),this.toggleDetails(app.viewmodel.curPlace()),app.map.infoWindow.close(),this.closeDrawer(),this.toggleDrawer()},clickHandler:function(e){var a=e||this;app.wiki.getWiki(a),app.foursquare.findPlace(a),app.map.infoWindow.close(),app.viewmodel.closeDrawer(),app.viewmodel.setCurrentPlace(a),app.viewmodel.toggleBounce(),setTimeout(function(){app.viewmodel.setInfoWindow(a),$("#drawer-btn").removeClass("closed"),$("#drawer-btn").addClass("open")},300)},placeFilter:function(){var e=this;return setTimeout(function(){if(e.inputText()){var a=e.places().filter(function(a){var o=a.name().toLowerCase(),t=e.inputText().toLowerCase();return 0===o.indexOf(t)});e.places().forEach(function(e){e.marker.setMap(null),e.show(!1)}),a.forEach(function(e){e.marker.setMap(app.map.map),e.show(!0)})}else e.places().forEach(function(e){e.marker.setMap(app.map.map),e.show(!0)})},100),!0},resetFilter:function(){app.viewmodel.inputText(""),$("#drawer-top input").trigger("input")},setInfoWindow:function(e){var a=$("#infowindow").html();app.map.infoWindow.setContent(a),app.map.infoWindow.open(app.map.map,e.marker)},toggleBounce:function(){if(app.viewmodel.curPlace().marker.getAnimation())app.viewmodel.curPlace().marker.setAnimation(null);else{var e=app.viewmodel.curPlace().marker;e.setAnimation(google.maps.Animation.BOUNCE)}},toggleDrawer:function(){var e=document.getElementsByClassName("drawer");$(e).toggleClass("closed open")},closeDrawer:function(){var e=$("#drawer-btn");e.hasClass("open")&&(e.removeClass("open"),e.addClass("closed")),$("#drawer-content").hasClass("open")&&app.viewmodel.toggleDrawer()},showDrawerBtn:function(){$("#drawer-btn").removeClass("open"),$("#drawer-btn").addClass("closed")},openModal:function(){$("#modal").css("display","initial"),console.log("Open Modal")},closeModal:function(){$("#modal").css("display","none")},init:function(){var e=document.getElementById("drawer-btn");e.addEventListener("click",app.viewmodel.toggleDrawer)}},app.viewmodel.init();
=======
!function(){function e(e,t,i){for(var a in t){var o=t[a],n=e.input.getAttribute("data-"+a.toLowerCase());"number"==typeof o?e[a]=parseInt(n):o===!1?e[a]=null!==n:o instanceof Function?e[a]=null:e[a]=n,e[a]||0===e[a]||(e[a]=a in i?i[a]:o)}}function t(e,t){return"string"==typeof e?(t||document).querySelector(e):e||null}function i(e,t){return n.call((t||document).querySelectorAll(e))}function a(){i("input.awesomplete").forEach(function(e){new o(e)})}var o=function(i,a){var n=this;this.input=t(i),this.input.setAttribute("autocomplete","off"),this.input.setAttribute("aria-autocomplete","list"),a=a||{},e(this,{minChars:1,maxItems:20,autoFirst:!1,filter:o.FILTER_CONTAINS,sort:o.SORT_BYLENGTH,item:o.ITEM,replace:o.REPLACE},a),this.index=-1,this.container=t.create("div",{className:"awesomplete",around:i}),this.ul=t.create("ul",{hidden:"hidden",inside:this.container}),this.status=t.create("span",{className:"visually-hidden",role:"status","aria-live":"assertive","aria-relevant":"additions",inside:this.container}),t.bind(this.input,{input:this.evaluate.bind(this),blur:this.close.bind(this),keydown:function(e){var t=e.keyCode;n.opened&&(13===t&&n.selected?(e.preventDefault(),n.select()):27===t?n.close():(38===t||40===t)&&(e.preventDefault(),n[38===t?"previous":"next"]()))}}),t.bind(this.input.form,{submit:this.close.bind(this)}),t.bind(this.ul,{mousedown:function(e){var t=e.target;if(t!==this){for(;t&&!/li/i.test(t.nodeName);)t=t.parentNode;t&&0===e.button&&(e.preventDefault(),n.select(t,e.target))}}}),this.input.hasAttribute("list")?(this.list="#"+this.input.getAttribute("list"),this.input.removeAttribute("list")):this.list=this.input.getAttribute("data-list")||a.list||[],o.all.push(this)};o.prototype={set list(e){Array.isArray(e)?this._list=e:"string"==typeof e&&e.indexOf(",")>-1?this._list=e.split(/\s*,\s*/):(e=t(e),e&&e.children&&(this._list=n.apply(e.children).map(function(e){return e.textContent.trim()}))),document.activeElement===this.input&&this.evaluate()},get selected(){return this.index>-1},get opened(){return!this.ul.hasAttribute("hidden")},close:function(){this.ul.setAttribute("hidden",""),this.index=-1,t.fire(this.input,"awesomplete-close")},open:function(){this.ul.removeAttribute("hidden"),this.autoFirst&&-1===this.index&&this["goto"](0),t.fire(this.input,"awesomplete-open")},next:function(){var e=this.ul.children.length;this["goto"](this.index<e-1?this.index+1:-1)},previous:function(){var e=this.ul.children.length;this["goto"](this.selected?this.index-1:e-1)},"goto":function(e){var i=this.ul.children;this.selected&&i[this.index].setAttribute("aria-selected","false"),this.index=e,e>-1&&i.length>0&&(i[e].setAttribute("aria-selected","true"),this.status.textContent=i[e].textContent),t.fire(this.input,"awesomplete-highlight")},select:function(e,i){if(e=e||this.ul.children[this.index]){var a=t.fire(this.input,"awesomplete-select",{text:e.textContent,data:this.suggestions[t.siblingIndex(e)],origin:i||e});a&&(this.replace(e.textContent),this.close(),t.fire(this.input,"awesomplete-selectcomplete"))}},evaluate:function(){var e=this,t=this.input.value;t.length>=this.minChars&&this._list.length>0?(this.index=-1,this.ul.innerHTML="",this.suggestions=this._list.filter(function(i){return e.filter(i,t)}).sort(this.sort).slice(0,this.maxItems),this.suggestions.forEach(function(i){e.ul.appendChild(e.item(i,t))}),0===this.ul.children.length?this.close():this.open()):this.close()}},o.all=[],o.FILTER_CONTAINS=function(e,i){return RegExp(t.regExpEscape(i.trim()),"i").test(e)},o.FILTER_STARTSWITH=function(e,i){return RegExp("^"+t.regExpEscape(i.trim()),"i").test(e)},o.SORT_BYLENGTH=function(e,t){return e.length!==t.length?e.length-t.length:t>e?-1:1},o.ITEM=function(e,i){var a=""===i?e:e.replace(RegExp(t.regExpEscape(i.trim()),"gi"),"<mark>$&</mark>");return t.create("li",{innerHTML:a,"aria-selected":"false"})},o.REPLACE=function(e){this.input.value=e};var n=Array.prototype.slice;return t.create=function(e,i){var a=document.createElement(e);for(var o in i){var n=i[o];if("inside"===o)t(n).appendChild(a);else if("around"===o){var r=t(n);r.parentNode.insertBefore(a,r),a.appendChild(r)}else o in a?a[o]=n:a.setAttribute(o,n)}return a},t.bind=function(e,t){if(e)for(var i in t){var a=t[i];i.split(/\s+/).forEach(function(t){e.addEventListener(t,a)})}},t.fire=function(e,t,i){var a=document.createEvent("HTMLEvents");a.initEvent(t,!0,!0);for(var o in i)a[o]=i[o];return e.dispatchEvent(a)},t.regExpEscape=function(e){return e.replace(/[-\\^$*+?.()|[\]{}]/g,"\\$&")},t.siblingIndex=function(e){for(var t=0;e=e.previousElementSibling;t++);return t},"undefined"!=typeof Document&&("loading"!==document.readyState?a():document.addEventListener("DOMContentLoaded",a)),o.$=t,o.$$=i,"undefined"!=typeof self&&(self.Awesomplete=o),"object"==typeof module&&module.exports&&(module.exports=o),o}(),/*!
 *
 *  Web Starter Kit
 *  Copyright 2015 Google Inc. All rights reserved.
 *
 *  Licensed under the Apache License, Version 2.0 (the "License");
 *  you may not use this file except in compliance with the License.
 *  You may obtain a copy of the License at
 *
 *    https://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License
 *
 */
function(){"use strict";var e=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));"serviceWorker"in navigator&&("https:"===window.location.protocol||e)&&navigator.serviceWorker.register("service-worker.js").then(function(e){"function"==typeof e.update&&e.update(),e.onupdatefound=function(){if(navigator.serviceWorker.controller){var t=e.installing;t.onstatechange=function(){switch(t.state){case"installed":break;case"redundant":throw new Error("The installing service worker became redundant.")}}}}})["catch"](function(e){console.error("Error during service worker registration:",e)})}();var app=app||{};app.map=app.map||{},function(){app.map={init:function(){var e={lat:39.927677,lng:-75.171909},t=document.getElementById("map-container");this.map=new google.maps.Map(t,{center:e,zoom:14,minZoom:12,maxZoom:18,mapTypeControl:!1}),this.placesApi=new google.maps.places.PlacesService(app.map.map),this.infoWindow=new google.maps.InfoWindow({maxWidth:.7*$(window).width()}),google.maps.event.addListener(this.infoWindow,"closeclick",function(){app.viewmodel.infoWindow(!1)}),setTimeout(function(){app.viewmodel.mapError("There appears to be a problem with Google Maps, please try refreshing the page")},5e3),google.maps.event.addListenerOnce(this.map,"bounds_changed",this.getPlaces)},createPlaces:function(e){e.forEach(function(e,t){var i=new app.viewmodel.Place(e);app.viewmodel.places.push(i),app.viewmodel.placeList.push(i.name()),1===t&&app.viewmodel.curPlace(i)}),app.viewmodel.autocomplete()},storePlaces:function(e){localStorage.setItem("places",JSON.stringify(e))},retrievePlaces:function(){var e=JSON.parse(localStorage.places);return e.forEach(function(e){var t=e.geometry.location.lat,i=e.geometry.location.lng;e.geometry.location.lat=function(){return t},e.geometry.location.lng=function(){return i}}),e},getPlaces:function(){if(localStorage.places&&app.map.sameBoundsCheck())console.log("Creating places from storage"),app.map.createPlaces(app.map.retrievePlaces()),ko.applyBindings(app.viewmodel);else{localStorage.setItem("bounds",JSON.stringify(app.map.map.getBounds()));var e={bounds:app.map.map.getBounds(),types:["art_gallery","museum","park"]};app.map.placesApi.nearbySearch(e,function(e,t){if(console.log("Calling Places API"),"OK"===t)app.map.setPhotoUrls(e),app.map.storePlaces(e),app.map.createPlaces(e);else{console.log("We have a places error");var i="Google Places Error: "+t;app.viewmodel.addError(i)}ko.applyBindings(app.viewmodel)})}},sameBoundsCheck:function(){var e=JSON.parse(localStorage.bounds);return app.map.map.getBounds().equals(e)},setPhotoUrls:function(e){e.forEach(function(e){if(e.photos){var t=e.photos[0].getUrl({maxWidth:200,maxHeight:300});e.photos[0].url=t}})},getPlaceDetails:function(e){var t={placeId:e.data.place_id};app.map.placesApi.getDetails(t,function(t,i){if("OK"===i){var a=new app.viewmodel.PlaceDetails(t);e.details(a)}else{var o="Google Places Error while getting details: "+i;app.viewmodel.addError(o)}})},createMarker:function(e){var t=e.data.geometry.location,i={url:e.data.icon,scaledSize:new google.maps.Size(50,50)},a=new google.maps.Marker({animation:google.maps.Animation.DROP,attribution:{source:"mrkjesus2.github.io/Neighborhood-Map"},icon:i,map:app.map.map,place:{location:{lat:t.lat(),lng:t.lng()},placeId:e.data.place_id},title:e.data.name});return google.maps.event.addListener(a,"click",function(){app.viewmodel.clickHandler(e)}),a}}}(),app.foursquare=app.foursquare||{},function(){var e="ZBGAM3NOJCK4P345ELK2JIB232FMDENJ05GXYQRSAHOHURJR",t="RGEF2DNONIR0AN2GHSIIMGZWLT0IH5JSJCJ5AGFAJ2WZDGLH";app.foursquare={baseUrl:"https://api.foursquare.com/v2/venues/",version:"20140806",findPlace:function(i){var a=i.data.geometry.location;jQuery.ajax({url:this.baseUrl+"search",data:{query:i.name(),ll:a.lat()+","+a.lng(),client_id:e,client_secret:t,v:this.version,limit:"1"},dataType:"json"}).done(function(e){var t=e.response.venues[0];app.foursquare.getTips(t,i)}).fail(function(e){var t="Foursquare Error: "+e.statusText;app.viewmodel.addError(t)})},getTips:function(i,a){jQuery.ajax({url:this.baseUrl+i.id+"/tips",data:{client_id:e,client_secret:t,v:this.version},dataType:"json"}).done(function(e){var t=e.response.tips;app.viewmodel.fourSquare(i,t,a),app.viewmodel.setInfoWindow(a)}).fail(function(e){var t="Foursquare Tips Error: "+e.statusText;app.viewmodel.addError(t)})}}}(),app.wiki=app.wiki||{},function(){app.wiki={getWiki:function(e){jQuery.ajax({url:"https://en.wikipedia.org/w/api.php",data:{action:"query",prop:"categories|extracts|info",exintro:"",exchars:1e3,inprop:"url",format:"json",redirects:"",converttitles:"",titles:e.name()},dataType:"jsonp",headers:{"Api-User-Agent":"Mark's Udacity Project"}}).done(function(t){var i=Object.keys(t.query.pages)[0],a=new app.viewmodel.WikiPage(t.query.pages[i]);void 0===a.content()||app.wiki.ambiguityChk(t,i)||(e.wikiInfo(a),app.viewmodel.setInfoWindow(e))}).fail(function(e){var t="Wikipedia Error: "+e.statusText;app.viewmodel.addError(t)})},ambiguityChk:function(e,t){var i=e.query.pages[t].categories;for(var a in i)return"Category:All article disambiguation pages"===i[a].title?!0:!1}}}(),app.viewmodel=app.viewmodel||{},app.viewmodel={mapError:ko.observable(),places:ko.observableArray(),placeList:[],curMarker:null,curPlace:ko.observable(),inputText:ko.observable(""),frsqr:null,errorMsg:ko.observableArray([]),infoWindow:ko.observable(!1),drawerOpen:ko.observable(!1),showModal:ko.observable(!1),Place:function(e){this.show=ko.observable(!0),this.name=ko.observable(e.name),this.rating=ko.observable(e.rating),this.open=ko.observable(e.opening_hours?"Open Now":"Closed"),e.photos?this.photo=ko.observable({url:ko.observable(e.photos[0].url),height:ko.observable(e.photos[0].height),width:ko.observable(e.photos[0].width),attributions:ko.observable(e.photos[0].html_attributions)}||{}):this.photo=ko.observable("none"),this.data=e,this.detailsIcon=ko.observable("fa fa-chevron-circle-up"),this.details=ko.observable(),this.marker=app.map.createMarker(this),this.wikiInfo=ko.observable(),this.frSqrInfo=ko.observable()},WikiPage:function(e){this.content=ko.observable(e.extract),this.url=ko.observable(e.fullurl)},fourSquare:function(e,t,i){var a=ko.mapping.fromJS(e,{}),o=ko.mapping.fromJS(t,{});a.tips=o,i.frSqrInfo(a)},PlaceDetails:function(e){this.show=ko.observable(!0),this.address=ko.observable(e.formatted_address),this.phone=ko.observable(e.formatted_phone_number),this.photos=ko.observableArray(e.photos),this.rating=ko.observable(e.rating),this.website=ko.observable(e.website),this.reviews=ko.observableArray(new app.viewmodel.Reviews(e.reviews))},Reviews:function(e){var t=[];return e.forEach(function(e){t.push({author:ko.observable(e.author_name),authorUrl:ko.observable(e.author_url),text:ko.observable(e.text),time:ko.observable(e.time)})}),t},addError:function(e){this.errorMsg=this.errorMsg||ko.observableArray([]),this.errorMsg.push(e),setTimeout(function(){app.viewmodel.clearErrors()},2e3)},clearErrors:function(){this.errorMsg([])},setCurrentPlace:function(e){app.viewmodel.curPlace().marker.getAnimation()&&app.viewmodel.toggleBounce(),app.viewmodel.curPlace(e)},toggleDetails:function(e){void 0!==e.details()&&e.details().show()===!0?(e.details().show(!1),e.detailsIcon("fa fa-chevron-circle-up")):(app.map.getPlaceDetails(e),app.viewmodel.setCurrentPlace(e),e.detailsIcon("fa fa-chevron-circle-down"))},clickContactInfo:function(){this.inputText(this.curPlace().name()),app.viewmodel.placeFilter(),this.toggleDetails(app.viewmodel.curPlace()),app.map.infoWindow.close(),app.viewmodel.infoWindow(!1),this.toggleDrawer()},clickHandler:function(e){var t=e||this;app.wiki.getWiki(t),app.foursquare.findPlace(t),app.map.infoWindow.close(),app.viewmodel.drawerOpen()&&app.viewmodel.toggleDrawer(),app.viewmodel.setCurrentPlace(t),app.viewmodel.toggleBounce()},findPlaceByName:function(e){for(var t=app.viewmodel.places(),i=t.length-1;i>=0;i--)if(t[i].name()===e)return t[i];return!1},placeFilter:function(){var e=this;if(e.inputText()){var t=e.places().filter(function(t){var i=t.name().toLowerCase(),a=e.inputText().toLowerCase();return i.indexOf(a)>=0});e.places().forEach(function(e){e.marker.setMap(null),e.show(!1)}),t.forEach(function(e){e.marker.setMap(app.map.map),e.show(!0)})}else e.places().forEach(function(e){e.marker.setMap(app.map.map),e.show(!0)});return!0},resetFilter:function(){app.viewmodel.inputText(""),app.viewmodel.placeFilter();for(var e=this.places(),t=e.length-1;t>=0;t--)e[t].details()&&e[t].details().show()&&(e[t].details().show(!1),e[t].detailsIcon("fa fa-chevron-circle-up"))},setInfoWindow:function(e){var t=$("#infowindow").html();app.map.infoWindow.setContent(t),app.map.infoWindow.open(app.map.map,e.marker),app.viewmodel.infoWindow(!0)},toggleBounce:function(){if(app.viewmodel.curPlace().marker.getAnimation())app.viewmodel.curPlace().marker.setAnimation(null);else{var e=app.viewmodel.curPlace().marker;e.setAnimation(google.maps.Animation.BOUNCE)}},toggleDrawer:function(){app.viewmodel.drawerOpen(!app.viewmodel.drawerOpen())},setModal:function(){app.viewmodel.showModal(!app.viewmodel.showModal())},autocomplete:function(){var e=document.getElementById("place-input"),t=new Awesomplete(e);t.list=app.viewmodel.placeList,e.addEventListener("awesomplete-selectcomplete",function(){var e=app.viewmodel.findPlaceByName(this.value);console.log(e),app.viewmodel.setCurrentPlace(e),app.viewmodel.toggleDetails(e),app.viewmodel.inputText(this.value),app.viewmodel.placeFilter()})}};
>>>>>>> dev
//# sourceMappingURL=main.min.js.map
