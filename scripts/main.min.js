app.foursquare=app.foursquare||{},function(){var e="ZBGAM3NOJCK4P345ELK2JIB232FMDENJ05GXYQRSAHOHURJR",o="RGEF2DNONIR0AN2GHSIIMGZWLT0IH5JSJCJ5AGFAJ2WZDGLH";app.foursquare={baseUrl:"https://api.foursquare.com/v2/venues/",version:"20140806",findPlace:function(a){var r=a.data.geometry.location;jQuery.ajax({url:this.baseUrl+"search",data:{query:a.name(),ll:r.lat()+","+r.lng(),client_id:e,client_secret:o,v:this.version,limit:"1"},dataType:"json"}).done(function(e){var o=e.response.venues[0];app.foursquare.getTips(o,a)}).fail(function(e){var o="Foursquare Error: "+e.statusText;app.viewmodel.addError(o)})},getTips:function(a,r){jQuery.ajax({url:this.baseUrl+a.id+"/tips",data:{client_id:e,client_secret:o,v:this.version},dataType:"json"}).done(function(e){var o=e.response.tips;app.viewmodel.fourSquare(a,o,r)}).fail(function(e){var o="Foursquare Tips Error: "+e.statusText;app.viewmodel.addError(o)})}}}(),app.wiki=app.wiki||{},function(){app.wiki={getWiki:function(e){jQuery.ajax({url:"https://en.wikipedia.org/w/api.php",data:{action:"query",prop:"categories|extracts|info",exintro:"",exchars:1e3,inprop:"url",format:"json",redirects:"",converttitles:"",titles:e.name()},dataType:"jsonp",headers:{"Api-User-Agent":"Mark's Udacity Project"}}).done(function(o){var a=Object.keys(o.query.pages)[0],r=new app.viewmodel.WikiPage(o.query.pages[a]);void 0===r.content()||app.wiki.ambiguityChk(o,a)||e.wikiInfo(r)}).fail(function(e){var o="Wikipedia Error: "+e.statusText;app.viewmodel.addError(o)})},ambiguityChk:function(e,o){var a=e.query.pages[o].categories;for(var r in a)return"Category:All article disambiguation pages"===a[r].title?!0:!1}}}(),app.viewmodel=app.viewmodel||{},app.viewmodel={places:ko.observableArray(),curMarker:null,curPlace:ko.observable(),inputText:ko.observable(""),frsqr:null,errorMsg:ko.observableArray([]),Place:function(e){this.show=ko.observable(!0),this.name=ko.observable(e.name),this.rating=ko.observable(e.rating),this.open=ko.observable(e.opening_hours?"Open Now":"Closed"),e.photos?this.photo=ko.observable({url:ko.observable(e.photos[0].url),height:ko.observable(e.photos[0].height),width:ko.observable(e.photos[0].width),attributions:ko.observable(e.photos[0].html_attributions)}||{}):this.photo=ko.observable("none"),this.data=e,this.detailsIcon=ko.observable("fa fa-chevron-circle-up"),this.details=ko.observable(),this.marker=app.map.createMarker(this),this.wikiInfo=ko.observable(),this.frSqrInfo=ko.observable()},WikiPage:function(e){this.content=ko.observable(e.extract),this.url=ko.observable(e.fullurl)},fourSquare:function(e,o,a){var r=ko.mapping.fromJS(e,{}),t=ko.mapping.fromJS(o,{});r.tips=t,a.frSqrInfo(r)},PlaceDetails:function(e){this.show=ko.observable(!0),this.address=ko.observable(e.formatted_address),this.phone=ko.observable(e.formatted_phone_number),this.photos=ko.observableArray(e.photos),this.rating=ko.observable(e.rating),this.website=ko.observable(e.website),this.reviews=ko.observableArray(new app.viewmodel.Reviews(e.reviews))},Reviews:function(e){var o=[];return e.forEach(function(e){o.push({author:ko.observable(e.author_name),authorUrl:ko.observable(e.author_url),text:ko.observable(e.text),time:ko.observable(e.time)})}),o},addError:function(e){this.errorMsg=this.errorMsg||ko.observableArray([]),this.errorMsg.push(e),setTimeout(function(){app.viewmodel.clearErrors()},2e3)},clearErrors:function(){this.errorMsg([])},setCurrentPlace:function(e){app.viewmodel.curPlace().marker.getAnimation()&&app.viewmodel.toggleBounce(),app.viewmodel.curPlace(e)},toggleDetails:function(e){void 0!==e.details()&&e.details().show()===!0?(e.details().show(!1),e.detailsIcon("fa fa-chevron-circle-up")):(app.map.getPlaceDetails(e),app.viewmodel.setCurrentPlace(e),e.detailsIcon("fa fa-chevron-circle-down"))},clickContactInfo:function(){this.inputText(this.curPlace().name()),$("#drawer-top input").trigger("input"),this.toggleDetails(app.viewmodel.curPlace()),app.map.infoWindow.close(),this.closeDrawer(),this.toggleDrawer()},clickHandler:function(e){var o=e||this;app.wiki.getWiki(o),app.foursquare.findPlace(o),app.map.infoWindow.close(),app.viewmodel.closeDrawer(),app.viewmodel.setCurrentPlace(o),app.viewmodel.toggleBounce(),setTimeout(function(){app.viewmodel.setInfoWindow(o),$("#drawer-btn").removeClass("closed"),$("#drawer-btn").addClass("open")},300)},placeFilter:function(){var e=this;return setTimeout(function(){if(e.inputText()){var o=e.places().filter(function(o){var a=o.name().toLowerCase(),r=e.inputText().toLowerCase();return 0===a.indexOf(r)});e.places().forEach(function(e){e.marker.setMap(null),e.show(!1)}),o.forEach(function(e){e.marker.setMap(app.map.map),e.show(!0)})}else e.places().forEach(function(e){e.marker.setMap(app.map.map),e.show(!0)})},100),!0},resetFilter:function(){app.viewmodel.inputText(""),$("#drawer-top input").trigger("input")},setInfoWindow:function(e){var o=$("#infowindow").html();app.map.infoWindow.setContent(o),app.map.infoWindow.open(app.map.map,e.marker)},toggleBounce:function(){if(app.viewmodel.curPlace().marker.getAnimation())app.viewmodel.curPlace().marker.setAnimation(null);else{var e=app.viewmodel.curPlace().marker;e.setAnimation(google.maps.Animation.BOUNCE)}},toggleDrawer:function(){var e=document.getElementsByClassName("drawer");$(e).toggleClass("closed open")},closeDrawer:function(){var e=$("#drawer-btn");e.hasClass("open")&&(e.removeClass("open"),e.addClass("closed")),$("#drawer-content").hasClass("open")&&app.viewmodel.toggleDrawer()},showDrawerBtn:function(){$("#drawer-btn").removeClass("open"),$("#drawer-btn").addClass("closed")},openModal:function(){$("#modal").css("display","initial"),console.log("Open Modal")},closeModal:function(){$("#modal").css("display","none")},init:function(){var e=document.getElementById("drawer-btn");e.addEventListener("click",app.viewmodel.toggleDrawer)}},app.viewmodel.init();
//# sourceMappingURL=main.min.js.map
